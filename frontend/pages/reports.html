<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Reports - CloudBased Expense Tracker</title>
  <link rel="stylesheet" href="../assets/css/style.css" />
  <link rel="stylesheet" href="../assets/css/dashboard.css" />
  <link rel="stylesheet" href="../assets/css/report.css" />
  <link rel="stylesheet" href="../assets/css/responsive.css" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
  <script src="../assets/js/auth.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', () => {
      checkAuth();
      fetch('./components/sidebar.html')
        .then(response => response.text())
        .then(data => {
          document.getElementById('sidebar').innerHTML = data;
          // Highlight active sidebar item
          const currentPage = window.location.pathname.split('/').pop();
          const activeLink = document.querySelector(`.sidebar-link[href*="reports"]`);
          if (activeLink) activeLink.classList.add('active');
        })
        .catch(error => console.error('Error loading sidebar:', error));
      
      // Initialize toggle sidebar functionality
      document.querySelector('.toggle-sidebar').addEventListener('click', () => {
        document.querySelector('.app-container').classList.toggle('sidebar-collapsed');
      });
    });
  </script>
</head>
<body>
  <div class="app-container">
    <nav class="sidebar" id="sidebar">
      <!-- Sidebar content will be loaded dynamically -->
    </nav>
   
    <div class="main-content">
      <div class="topbar">
        <div class="toggle-sidebar"><i class="fas fa-bars"></i></div>
        <div class="user-info">
          <div class="notifications">
            <i class="fas fa-bell"></i>
            <div class="badge">3</div>
          </div>
          <div class="user-profile">
            <span id="username">John Doe</span>
            <div class="avatar" id="avatar">JD</div>
          </div>
        </div>
      </div>
     
      <header class="page-header">
        <h1>Financial Reports</h1>
        <p>Analyze your spending habits and financial trends</p>
      </header>
      
      <div class="report-controls">
        <div class="filter-group">
          <label for="report-period">Time Period:</label>
          <select id="report-period" class="form-control">
            <option value="current-month">Current Month</option>
            <option value="last-month">Last Month</option>
            <option value="last-3-months">Last 3 Months</option>
            <option value="last-6-months">Last 6 Months</option>
            <option value="year-to-date">Year to Date</option>
            <option value="last-year">Last Year</option>
          </select>
        </div>
        <div class="filter-group">
          <label for="report-type">Report Type:</label>
          <select id="report-type" class="form-control">
            <option value="category">By Category</option>
            <option value="monthly">Monthly Comparison</option>
            <option value="trend">Spending Trend</option>
          </select>
        </div>
        <button id="generate-report" class="btn btn-primary">Generate Report</button>
        <button id="export-pdf" class="btn btn-outline"><i class="fas fa-file-pdf"></i> Export PDF</button>
      </div>
     
      <div class="dashboard-grid">
        <div class="card summary-card">
          <div class="card-header">
            <h3>Expense Summary</h3>
          </div>
          <div class="card-body">
            <div class="metric">
              <div class="metric-value" id="total-expenses">0.00</div>
              <div class="metric-label">Total Expenses</div>
            </div>
            <div class="metrics-grid">
              <div class="metric">
                <div class="metric-value" id="avg-daily">0.00</div>
                <div class="metric-label">Daily Average</div>
              </div>
              <div class="metric">
                <div class="metric-value" id="highest-category">-</div>
                <div class="metric-label">Highest Category</div>
              </div>
              <div class="metric">
                <div class="metric-value" id="expense-count">0</div>
                <div class="metric-label">Transactions</div>
              </div>
              <div class="metric">
                <div class="metric-value trend-up" id="trend"><i class="fas fa-arrow-up"></i> 0%</div>
                <div class="metric-label">vs Previous</div>
              </div>
            </div>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3>Expense Breakdown by Category</h3>
          </div>
          <div class="card-body chart-container">
            <canvas id="reportChart" style="width:100%; height:300px;"></canvas>
          </div>
        </div>
        
        <!-- For Monthly/Daily/Weekly Trend -->
        <div class="card">
          <div class="card-header">
            <h3>Spending Trend</h3>
          </div>
          <div class="card-body chart-container">
            <canvas id="trendChart" style="width:100%; height:300px;"></canvas>
          </div>
        </div>
        
        <div class="card">
          <div class="card-header">
            <h3>Daily/Weekly/Monthly/Yearly Summary</h3>
          </div>
          <div class="card-body">
            <div class="table-responsive">
              <table class="data-table" id="expenses-table">
                <thead>
                  <tr>
                    <th>Date</th>
                    <th>Title</th>
                    <th>Total Spent</th>
                  </tr>
                </thead>
                <tbody>
                  <!-- Rows will be dynamically added here -->
                </tbody>
              </table>
            </div>
          </div>
        </div>
      
      <!-- <div class="card">
        <div class="card-header">
          <h3>Insights & Recommendations</h3>
        </div>
        <div class="card-body">
          <div id="insights-container">
            <div class="insight-item">
              <div class="insight-icon"><i class="fas fa-lightbulb"></i></div>
              <div class="insight-content">
                <h4>Loading insights...</h4>
                <p>Please wait while we analyze your spending patterns.</p>
              </div>
            </div>
          </div>
        </div>
      </div> -->
    </div>
  </div>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
  <script src="../assets/js/report.js"></script>
  <script>
    alert("âœ… User stored in localStorage:"+ localStorage.getItem('user'));
  </script>
</body>
</html>